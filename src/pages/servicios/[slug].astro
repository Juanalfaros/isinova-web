---
export const prerender = true;

import Layout from "../../layouts/Layout.astro";

// Service Components
import ServiceHero from "../../components/services/ServiceHero.astro";
import ServicePainPoints from "../../components/services/ServicePainPoints.astro";
import ServiceTimeline from "../../components/services/ServiceTimeline.astro";
import ServicePricingCard from "../../components/services/ServicePricingCard.astro";
import ServiceHighlightBox from "../../components/services/ServiceHighlightBox.astro";
import ServiceFAQ from "../../components/services/ServiceFAQ.astro";
import ServiceCTA from "../../components/services/ServiceCTA.astro";

// Static imports for images
import imgLms from "../../assets/images/services/lms-isinova.webp";
import imgMigracion from "../../assets/images/services/migracion-isinova.webp";
import imgSoporte from "../../assets/images/services/soporte-isinova.webp";
import imgWeb from "../../assets/images/services/web-edtech-isinova.webp";

const imageMap: Record<string, any> = {
    "images/services/lms-isinova.webp": imgLms,
    "images/services/migracion-isinova.webp": imgMigracion,
    "images/services/soporte-isinova.webp": imgSoporte,
    "images/services/web-edtech-isinova.webp": imgWeb,
};

import { getCollection, render, type CollectionEntry } from "astro:content";

export async function getStaticPaths() {
    const services = await getCollection("servicios");
    return services.map((service: CollectionEntry<"servicios">) => ({
        params: { slug: service.slug },
        props: { service },
    }));
}

type Props = {
    service: CollectionEntry<"servicios">;
};

const { service } = Astro.props;
const { Content } = await render(service);
const data = service.data;

const serviceImage = imageMap[data.heroImage] || imgLms;
---

<Layout title={`${data.title} | Isinova`} description={data.description}>
    <main class="service-page-main">
        <!-- HERO -->
<ServiceHero
            title={data.title}
            shortTitle={data.shortTitle ?? data.title}  heroTitle={data.heroTitle}
            tags={data.tags}
            icon={data.icon}
            serviceImage={serviceImage}
            slug={service.slug}
        />

        <!-- PAIN POINTS -->
        <ServicePainPoints
            badgeText={data.titleSituaciones}
            title={data.subtitleSituaciones}
            items={data.situaciones}
        />

        <!-- PROCESS SECTION (Dark) -->
        <section class="section-process bg-tech-dark">
            <div class="bg-base"></div>
            <div class="tech-grid-bg"></div>

            <div class="container relative-z">
                <div class="content-grid-layout">
                    <div class="main-content">
                        <!-- MDX Content -->
                        <article class="prose-content">
                            <Content />
                        </article>

                        <!-- Timeline -->
                        <ServiceTimeline
                            title={data.titleEnfoque}
                            steps={data.enfoque}
                        />

                        <!-- Highlight Box -->
                        <ServiceHighlightBox
                            title={data.highlightBox.h3}
                            text={data.highlightBox.p}
                        />
                    </div>

                    <!-- Sidebar Pricing Card -->
                    <ServicePricingCard
                        title={data.bookingCard.title}
                        subtitle={data.bookingCard.paragraph}
                        price={data.price}
                        duration={data.duration}
                        benefits={data.bookingCard.benefits}
                        buttonText={data.bookingCard.buttonText}
                    />
                </div>
            </div>
        </section>

        <!-- FAQ -->
        <ServiceFAQ
            title={data.titleFaqs}
            subtitle={data.subtitleFaqs}
            faqs={data.faqs}
        />

        <!-- CTA -->
        <ServiceCTA
            title={data.bookingCard.title}
            buttonText={data.bookingCard.buttonText}
            serviceName={data.title}
        />
    </main>
</Layout>

<style>
    /* --- LAYOUT UTILITIES --- */
    .service-page-main {
        padding-top: 0;
    }

    .relative-z {
        position: relative;
        z-index: 10;
    }

    /* --- PROCESS SECTION --- */
    .section-process {
        padding: 6rem 0;
    }

    .content-grid-layout {
        display: grid;
        grid-template-columns: 1fr;
        gap: 4rem;
    }

    @media (min-width: 992px) {
        .content-grid-layout {
            grid-template-columns: 1.5fr 1fr;
            gap: 5rem;
        }
    }

    /* --- PROSE CONTENT (MDX) --- */
    .prose-content :global(h2),
    .prose-content :global(h3) {
        font-size: 2rem;
        color: white;
        font-weight: 800;
        margin-bottom: 1.5rem;
    }

    @media (min-width: 768px) {
        .prose-content :global(h2),
        .prose-content :global(h3) {
            font-size: 2.75rem;
        }
    }

    .prose-content :global(p) {
        font-size: 1.1rem;
        color: #94a3b8;
        line-height: 1.8;
        margin-bottom: 1.5rem;
    }

    .prose-content :global(strong) {
        color: white;
    }

    .prose-content :global(.prose-p) {
        font-size: 1.1rem;
        color: #94a3b8;
        line-height: 1.8;
        margin-bottom: 1.5rem;
    }

    .prose-content :global(.prose-p strong) {
        color: white;
    }

    /* --- ANIMATIONS --- */
    @keyframes float {
        0%,
        100% {
            transform: translateY(0px);
        }
        50% {
            transform: translateY(-10px);
        }
    }

    .animate-float {
        animation: float 6s ease-in-out infinite;
    }
</style>
